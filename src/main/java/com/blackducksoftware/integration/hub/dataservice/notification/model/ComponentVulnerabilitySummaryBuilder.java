/**
 * Hub Common
 *
 * Copyright (C) 2017 Black Duck Software, Inc.
 * http://www.blackducksoftware.com/
 *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
package com.blackducksoftware.integration.hub.dataservice.notification.model;

import java.util.ArrayList;
import java.util.List;

import com.blackducksoftware.integration.hub.api.vulnerability.SeverityEnum;

import io.swagger.client.model.VulnerabilityView;

public class ComponentVulnerabilitySummaryBuilder {

	private String componentName;

	private String componentVersion;

	private List<VulnerabilityView> vulnerabilityList;

	public ComponentVulnerabilitySummaryBuilder() {
		componentName = "";
		componentVersion = "";
		vulnerabilityList = new ArrayList<>();
	}

	public String getComponentName() {
		return componentName;
	}

	public void setComponentName(final String componentName) {
		this.componentName = componentName;
	}

	public String getComponentVersion() {
		return componentVersion;
	}

	public void setComponentVersion(final String componentVersion) {
		this.componentVersion = componentVersion;
	}

	public List<VulnerabilityView> getVulnerabilityList() {
		return vulnerabilityList;
	}

	public void setVulnerabilityList(final List<VulnerabilityView> vulnerabilityList) {
		this.vulnerabilityList = vulnerabilityList;
	}

	public ComponentVulnerabilitySummary build() {
		int total = 0;
		int highCount = 0;
		int mediumCount = 0;
		int lowCount = 0;
		if (vulnerabilityList != null && vulnerabilityList.size() > 0) {
			total = vulnerabilityList.size();
			for (final VulnerabilityView item : vulnerabilityList) {
				final SeverityEnum severity = SeverityEnum.getSeverityEnum(item.getSeverity().toString());
				switch (severity) {
				case HIGH: {
					highCount++;
					break;
				}
				case MEDIUM: {
					mediumCount++;
					break;
				}
				case LOW: {
					lowCount++;
					break;
				}
				default: {
					// do nothing
				}
				}
			}
		}

		return new ComponentVulnerabilitySummary(componentName, componentVersion, highCount, mediumCount, lowCount, total);
	}
}
